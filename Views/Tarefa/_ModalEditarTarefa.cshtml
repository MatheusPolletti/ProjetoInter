@model ProjetoInter.Models.Procedimento
@{
    Layout = null;
    var animais = ViewBag.Animais as List<ProjetoInter.Models.Animal> ?? new List<ProjetoInter.Models.Animal>();
}

<link rel="stylesheet" href="~/css/TelaTarefa.css" />

<div class="area-modal-editar modal" style="display:none">
    <div class="modal-conteudo">
        <span class="fechar">×</span>
        <h2>Editar Tarefa</h2>

        <form id="formEditarTarefa" method="post" asp-controller="Tarefa" asp-action="EditarTarefa" enctype="multipart/form-data">
            @Html.AntiForgeryToken()

            <input type="hidden" asp-for="ProcedimentoId" />

            <div class="form-linha">
                <div class="form-grupo">
                    <label asp-for="Descricao">Descrição:</label>
                    <input asp-for="Descricao" class="inputTexto" required />
                </div>
            </div>

            <div class="form-linha">
                <div class="form-grupo">
                    <label asp-for="AnimalId">Animal:</label>
                    <select asp-for="AnimalId" class="inputTexto" required>
                        <option value="">Selecione um animal</option>
                        @foreach (var animal in animais)
                        {
                            <option value="@animal.AnimalId">@animal.Nome - @animal.Especie?.Descricao</option>
                        }
                    </select>
                </div>

                <div class="form-grupo">
                    <label asp-for="DataProcedimento">Data:</label>
                    <input asp-for="DataProcedimento" type="date" class="inputTexto" required 
                           value="@Model.DataProcedimento.ToString("yyyy-MM-dd")" />
                </div>
            </div>

            <div class="form-linha">
                <div class="form-grupo">
                    <label asp-for="Observacoes">Observações:</label>
                    <textarea asp-for="Observacoes" rows="3"></textarea>
                </div>
            </div>

            <div class="form-linha">
                <div class="form-grupo">
                    <label asp-for="Status">Concluída:</label>
                    <input type="checkbox" asp-for="Status" />
                </div>
            </div>

            <input type="hidden" asp-for="FuncionarioTarefaId" />

            <div class="form-linha" style="justify-content: center; margin-top: 20px">
                <button type="submit" class="submit-button btn-atualizar">Salvar Alterações</button>
            </div>

            <div id="formEditarTarefaErrors" style="color: red; margin-top: 10px;"></div>
        </form>
    </div>
</div>

<script>
    // Configura o evento de fechamento do modal
    document.querySelector('.area-modal-editar .fechar').addEventListener('click', function() {
        document.body.removeChild(document.getElementById('modal-editar-container'));
    });
</script>